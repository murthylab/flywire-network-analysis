# flywire-network-analysis
This repository contains analysis scripts for the network analyses of the Flywire connectome. 

Network Paper Preprint: Lin, Yang et al. 2023, "Network Statistics of the Whole-Brain Connectome of Drosophila" (https://www.biorxiv.org/content/10.1101/2023.07.29.551086v2)

Data Paper Preprint: Dorkenwald et al. 2023, "Neuronal wiring diagram of an adult brain" (https://www.biorxiv.org/content/10.1101/2023.06.27.546656v2)

Data exports of the Flywire connectome are hosted at https://codex.flywire.ai/api/download. The analyses in the paper were conducted with the v630 snapshot of the Flywire connectome.

## Python Scripts

 - **[FlywireAnalysis/v630-Animal-Comparison.ipynb](python_scripts/FlywireAnalysis/v630-Animal-Comparison.ipynb)**: network definition, synapse and degree distributions, strong and weak connected component analyses, edge percolation, edge reciprocity, clustering coefficient, shortest path, small-world-ness
 - **[FlywireAnalysis/v630-Motif-Analysis.ipynb](python_scripts/FlywireAnalysis/v630-Motif-Analysis.ipynb)**: Motif frequency and strengh distributions
 - **[FlywireAnalysis/v630-Proximity-Model.ipynb](python_scripts/FlywireAnalysis/v630-Proximity-Model.ipynb)**: Connectivity vs. distance distribution and neuron-neuron distance (NND) model: connection probability vs neuron pair arbor distance
 - **[FlywireAnalysis/v630-Rich-Club.ipynb](python_scripts/FlywireAnalysis/v630-Rich-Club.ipynb)**: Rich-club analysis with a configuration (CFG) model and a neuropil connection (NPC) null model
 - **[FlywireAnalysis/v630-Spectral-Properties.ipynb](python_scripts/FlywireAnalysis/v630-Spectral-Properties.ipynb)**: Random walk and spectral properties
 - **[FlywireAnalysis/v630-Animal-Comparison.ipynb](python_scripts/FlywireAnalysis/v630-Animal-Comparison.ipynb)**: Compute and network statistics across existing wiring diagrams from different animals
 - **[Rank_analysis.ipynb](python_scripts/Rank_analysis.ipynb)** contains the following analyses: relative rank of rich club neuron populations to different sensory inputs, scatterplots comparing relative rank to multiple modalities

**reciprocal_space.ipynb** contains the following analyses: inter-neuropil neciprocal projectome matrices

**utils & flywireconnectome_utils** contain secondary scripts called in the Python notebooks.

## MATLAB Scripts
**flywire_analyses_codex.m** contains the following analyses: fractional neuropil projectomes, internal and external neuropil fractions, neuropil fractions by putative neurotransmitter

**flywire_reciprocal_connectivity.m** contains the following analyses: degree scatterplots, distributions of reciprocal connections and reciprocal degree, reciprocity by neurotransmitter, relative reciprocal degree heatmaps, neuropil-specific highly reciprocal neurons, identifying integrators and broadcasters, characterize properties (cell type, neurotransmitter, etc) of integrators, broadcasters, and rich club neurons

## Data Products
This folder contains data outputs not found on Codex, including the color pallettes used for neuropils, neurotransmitters, and cell types, neuron root_ID lists for various neuron populations, the root_ID list of all reciprocal pairs in v630, and the ranks of neurons from sensory inputs.

## Credits
Albert Lin, Runzhe Yang, Sven Dorkenwald

Codex data exports generated by Arie Matsliah
